<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Spring Boot 를 이용해 JWT + Social 로그인 처리 - Resource Server | Seo Yang Hun Blog</title>
  <meta name="keywords" content="">
  <meta name="description" content="Spring Boot 를 이용해 JWT + Social 로그인 처리 - Resource Server | Seo Yang Hun Blog">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="캐시 전략기본적으로 웹서비스 경우 데이터베이스 통해 수집, 저장, 관리, 검색 역할을 하고 있습니다. 하지만 많은 트래픽이 발생이 하면 캐싱을 하게 되는데 기본적으로 데이터베이스 (디스크) 보다 메모리 (RAM) 같은 빠른 임시 저장소에 저장 해서 관리 하게 됩니다. 이는 어플리케이션 응답 속도를 획기적으로 높이고, 데이터베이스 부하를 줄이는데 획기적인 방">
<meta property="og:type" content="article">
<meta property="og:title" content="캐시 전략">
<meta property="og:url" content="https://syh8088.github.io/2025/12/28/NoSQL/CACHE_STRATEGY/CacheStrategy/index.html">
<meta property="og:site_name" content="Seo Yang Hun Blog">
<meta property="og:description" content="캐시 전략기본적으로 웹서비스 경우 데이터베이스 통해 수집, 저장, 관리, 검색 역할을 하고 있습니다. 하지만 많은 트래픽이 발생이 하면 캐싱을 하게 되는데 기본적으로 데이터베이스 (디스크) 보다 메모리 (RAM) 같은 빠른 임시 저장소에 저장 해서 관리 하게 됩니다. 이는 어플리케이션 응답 속도를 획기적으로 높이고, 데이터베이스 부하를 줄이는데 획기적인 방">
<meta property="og:locale">
<meta property="og:image" content="https://syh8088.github.io/img/NoSQL/CACHE_STRATEGY/1.CachePenetration.png">
<meta property="og:image" content="https://syh8088.github.io/img/NoSQL/CACHE_STRATEGY/1-1.NullObjectPattern.png">
<meta property="og:image" content="https://syh8088.github.io/img/NoSQL/CACHE_STRATEGY/1-2-1.BloomFilter.png">
<meta property="og:image" content="https://syh8088.github.io/img/NoSQL/CACHE_STRATEGY/1-2-2.BloomFilter.png">
<meta property="og:image" content="https://syh8088.github.io/img/NoSQL/CACHE_STRATEGY/1-2-3.BloomFilter.png">
<meta property="og:image" content="https://syh8088.github.io/img/NoSQL/CACHE_STRATEGY/1-2-4.BloomFilter.png">
<meta property="og:image" content="https://syh8088.github.io/img/NoSQL/CACHE_STRATEGY/1-2-5.BloomFilter.png">
<meta property="og:image" content="https://syh8088.github.io/img/NoSQL/CACHE_STRATEGY/1-2-6.BloomFilter.png">
<meta property="og:image" content="https://syh8088.github.io/img/NoSQL/CACHE_STRATEGY/1-2-7.BloomFilter.png">
<meta property="og:image" content="https://syh8088.github.io/img/NoSQL/CACHE_STRATEGY/1-2-8.BloomFilter.png">
<meta property="og:image" content="https://syh8088.github.io/img/NoSQL/CACHE_STRATEGY/1-2-9.BloomFilter.png">
<meta property="og:image" content="https://syh8088.github.io/img/NoSQL/CACHE_STRATEGY/2.CacheStampede.png">
<meta property="og:image" content="https://syh8088.github.io/img/NoSQL/CACHE_STRATEGY/2-1.Jitter.png">
<meta property="og:image" content="https://syh8088.github.io/img/NoSQL/CACHE_STRATEGY/2-2-1.ProbabilisticEarlyRecomputation(PER).png">
<meta property="og:image" content="https://syh8088.github.io/img/NoSQL/CACHE_STRATEGY/2-2-2.ProbabilisticEarlyRecomputation(PER).png">
<meta property="og:image" content="https://syh8088.github.io/img/NoSQL/CACHE_STRATEGY/2-3-1.RequestCollapsing.png">
<meta property="og:image" content="https://syh8088.github.io/img/NoSQL/CACHE_STRATEGY/2-3-2.RequestCollapsing.png">
<meta property="og:image" content="https://syh8088.github.io/img/NoSQL/CACHE_STRATEGY/2-4.RateLimit.png">
<meta property="og:image" content="https://syh8088.github.io/img/NoSQL/CACHE_STRATEGY/2-5-1.WriteThrough.png">
<meta property="og:image" content="https://syh8088.github.io/img/NoSQL/CACHE_STRATEGY/2-5-2.WriteThrough.png">
<meta property="og:image" content="https://syh8088.github.io/img/NoSQL/CACHE_STRATEGY/2-5-3.WriteThrough.png">
<meta property="og:image" content="https://syh8088.github.io/img/NoSQL/CACHE_STRATEGY/2-5-4.WriteThrough.png">
<meta property="og:image" content="https://syh8088.github.io/img/NoSQL/CACHE_STRATEGY/2-5-5.WriteThrough.png">
<meta property="og:image" content="https://syh8088.github.io/img/NoSQL/CACHE_STRATEGY/2-5-6.WriteThrough.png">
<meta property="og:image" content="https://syh8088.github.io/img/NoSQL/CACHE_STRATEGY/3_1.HotKey.png">
<meta property="og:image" content="https://syh8088.github.io/img/NoSQL/CACHE_STRATEGY/3_2.HotKey.png">
<meta property="article:published_time" content="2025-12-27T22:47:42.000Z">
<meta property="article:modified_time" content="2025-12-28T14:00:52.807Z">
<meta property="article:author" content="Seo Yang Hun">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://syh8088.github.io/img/NoSQL/CACHE_STRATEGY/1.CachePenetration.png">


<link rel="icon" href="/img/avatar.jpg">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/atom-light.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 7.2.0"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/avatar.jpg"/>
</a>
<div class="author">
    <span>Seo Yang Hun</span>
</div>

<div class="icon">
    
        
            <a title="rss"
               href="/atom.xml"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-rss"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="github"
               href="https://github.com/syh8088"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                
            </a>
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
            <a title="email"
               href="mailto:syh8088@gmail.com"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-email"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="qq"
               href="http://wpa.qq.com/msgrd?v=3&uin=872336115&site=qq&menu=yes"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-qq"></use>
                    </svg>
                
            </a>
        
    
        
    
        
    
</div>





<ul>
    <li>
        <div class="all active" data-rel="All">All
            
                <small>(69)</small>
            
        </div>
    </li>
    
        
            
                
    <li>
        <div data-rel="Authentication">
            <i class="fold iconfont icon-right"></i>
            Authentication
            <small>(2)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="Authentication&lt;---&gt;JWT">
            
            JWT
            <small>(1)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="Authentication&lt;---&gt;Oauth">
            
            Oauth
            <small>(1)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="AWS">
            <i class="fold iconfont icon-right"></i>
            AWS
            <small>(1)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="AWS&lt;---&gt;Image Resizing">
            
            Image Resizing
            <small>(1)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

            
        
    
        
            
        
    
        
            
        
    
        
            
                
    <li>
        <div data-rel="CI-CD">
            <i class="fold iconfont icon-right"></i>
            CI-CD
            <small>(10)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="CI-CD&lt;---&gt;AWS">
            <i class="fold iconfont icon-right"></i>
            AWS
            <small>(1)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="CI-CD&lt;---&gt;AWS&lt;---&gt;EKS">
            <i class="fold iconfont icon-right"></i>
            EKS
            <small>(1)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="CI-CD&lt;---&gt;AWS&lt;---&gt;EKS&lt;---&gt;Kubernetes">
            <i class="fold iconfont icon-right"></i>
            Kubernetes
            <small>(1)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="CI-CD&lt;---&gt;AWS&lt;---&gt;EKS&lt;---&gt;Kubernetes&lt;---&gt;Docker">
            
            Docker
            <small>(1)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

                
            </ul>
        
    </li>

                
            </ul>
        
    </li>

                
                    
    <li>
        <div data-rel="CI-CD&lt;---&gt;GitHubActions">
            
            GitHubActions
            <small>(6)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="CI-CD&lt;---&gt;Jenkins">
            
            Jenkins
            <small>(3)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

            
        
    
        
            
        
    
        
            
        
    
        
            
                
    <li>
        <div data-rel="DB">
            <i class="fold iconfont icon-right"></i>
            DB
            <small>(5)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="DB&lt;---&gt;Mysql">
            <i class="fold iconfont icon-right"></i>
            Mysql
            <small>(4)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="DB&lt;---&gt;Mysql&lt;---&gt;DBCP">
            
            DBCP
            <small>(1)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="DB&lt;---&gt;Mysql&lt;---&gt;optimizing">
            
            optimizing
            <small>(1)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="DB&lt;---&gt;Mysql&lt;---&gt;Paging">
            
            Paging
            <small>(1)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

                
                    
    <li>
        <div data-rel="DB&lt;---&gt;MySql">
            <i class="fold iconfont icon-right"></i>
            MySql
            <small>(1)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="DB&lt;---&gt;MySql&lt;---&gt;Collation">
            
            Collation
            <small>(1)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

                
            </ul>
        
    </li>

            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
                
    <li>
        <div data-rel="Elastic Search">
            
            Elastic Search
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
        
    
        
            
                
    <li>
        <div data-rel="Flink">
            <i class="fold iconfont icon-right"></i>
            Flink
            <small>(1)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="Flink&lt;---&gt;Real Time">
            <i class="fold iconfont icon-right"></i>
            Real Time
            <small>(1)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="Flink&lt;---&gt;Real Time&lt;---&gt;Kafka">
            
            Kafka
            <small>(1)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

                
            </ul>
        
    </li>

            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
                
    <li>
        <div data-rel="J">
            <i class="fold iconfont icon-right"></i>
            J
            <small>(1)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="J&lt;---&gt;Jenkins">
            
            Jenkins
            <small>(1)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="JAVA">
            <i class="fold iconfont icon-right"></i>
            JAVA
            <small>(29)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="JAVA&lt;---&gt;HTTP">
            <i class="fold iconfont icon-right"></i>
            HTTP
            <small>(1)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="JAVA&lt;---&gt;HTTP&lt;---&gt;FeignClient">
            
            FeignClient
            <small>(1)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

                
                    
    <li>
        <div data-rel="JAVA&lt;---&gt;JPA">
            
            JPA
            <small>(1)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="JAVA&lt;---&gt;Object">
            
            Object
            <small>(2)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="JAVA&lt;---&gt;Payment">
            
            Payment
            <small>(5)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="JAVA&lt;---&gt;Security">
            
            Security
            <small>(4)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="JAVA&lt;---&gt;Spring">
            <i class="fold iconfont icon-right"></i>
            Spring
            <small>(2)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="JAVA&lt;---&gt;Spring&lt;---&gt;Payment">
            <i class="fold iconfont icon-right"></i>
            Payment
            <small>(2)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="JAVA&lt;---&gt;Spring&lt;---&gt;Payment&lt;---&gt;junit5">
            <i class="fold iconfont icon-right"></i>
            junit5
            <small>(2)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="JAVA&lt;---&gt;Spring&lt;---&gt;Payment&lt;---&gt;junit5&lt;---&gt;Mockito">
            
            Mockito
            <small>(2)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

                
            </ul>
        
    </li>

                
            </ul>
        
    </li>

                
                    
    <li>
        <div data-rel="JAVA&lt;---&gt;SpringBatch">
            
            SpringBatch
            <small>(5)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="JAVA&lt;---&gt;SpringBootAndSecurityAndJWT">
            
            SpringBootAndSecurityAndJWT
            <small>(3)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="JAVA&lt;---&gt;SpringCloudConfig">
            
            SpringCloudConfig
            <small>(4)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="JAVA&lt;---&gt;Transaction">
            
            Transaction
            <small>(1)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="JAVA&lt;---&gt;Validator">
            
            Validator
            <small>(1)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="JavaScript">
            <i class="fold iconfont icon-right"></i>
            JavaScript
            <small>(1)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="JavaScript&lt;---&gt;Webpack">
            
            Webpack
            <small>(1)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
                
    <li>
        <div data-rel="Kafka">
            <i class="fold iconfont icon-right"></i>
            Kafka
            <small>(2)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="Kafka&lt;---&gt;idempotent">
            
            idempotent
            <small>(1)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
                
    <li>
        <div data-rel="KUBERNETES">
            
            KUBERNETES
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
        
    
        
            
                
    <li>
        <div data-rel="MSA">
            <i class="fold iconfont icon-right"></i>
            MSA
            <small>(3)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="MSA&lt;---&gt;Payment">
            <i class="fold iconfont icon-right"></i>
            Payment
            <small>(3)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="MSA&lt;---&gt;Payment&lt;---&gt;Kafka">
            <i class="fold iconfont icon-right"></i>
            Kafka
            <small>(3)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="MSA&lt;---&gt;Payment&lt;---&gt;Kafka&lt;---&gt;EDA">
            <i class="fold iconfont icon-right"></i>
            EDA
            <small>(3)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="MSA&lt;---&gt;Payment&lt;---&gt;Kafka&lt;---&gt;EDA&lt;---&gt;CQRS">
            
            CQRS
            <small>(1)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="MSA&lt;---&gt;Payment&lt;---&gt;Kafka&lt;---&gt;EDA&lt;---&gt;Saga">
            <i class="fold iconfont icon-right"></i>
            Saga
            <small>(1)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="MSA&lt;---&gt;Payment&lt;---&gt;Kafka&lt;---&gt;EDA&lt;---&gt;Saga&lt;---&gt;Axon">
            
            Axon
            <small>(1)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

                
            </ul>
        
    </li>

                
            </ul>
        
    </li>

                
            </ul>
        
    </li>

                
            </ul>
        
    </li>

            
        
    
        
            
        
    
        
            
        
    
        
            
                
    <li>
        <div data-rel="Network">
            
            Network
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="NoSQL">
            <i class="fold iconfont icon-right"></i>
            NoSQL
            <small>(2)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="NoSQL&lt;---&gt;Redis">
            <i class="fold iconfont icon-right"></i>
            Redis
            <small>(2)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="NoSQL&lt;---&gt;Redis&lt;---&gt;RateLimiter">
            
            RateLimiter
            <small>(1)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

                
            </ul>
        
    </li>

            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
                
    <li>
        <div data-rel="R">
            
            R
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
                
    <li>
        <div data-rel="대용량 트래픽">
            <i class="fold iconfont icon-right"></i>
            대용량 트래픽
            <small>(3)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="대용량 트래픽&lt;---&gt;EDA">
            <i class="fold iconfont icon-right"></i>
            EDA
            <small>(1)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="대용량 트래픽&lt;---&gt;EDA&lt;---&gt;Payment">
            <i class="fold iconfont icon-right"></i>
            Payment
            <small>(1)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="대용량 트래픽&lt;---&gt;EDA&lt;---&gt;Payment&lt;---&gt;Redis">
            <i class="fold iconfont icon-right"></i>
            Redis
            <small>(1)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="대용량 트래픽&lt;---&gt;EDA&lt;---&gt;Payment&lt;---&gt;Redis&lt;---&gt;Kafka">
            
            Kafka
            <small>(1)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

                
            </ul>
        
    </li>

                
            </ul>
        
    </li>

                
                    
    <li>
        <div data-rel="대용량 트래픽&lt;---&gt;Redis">
            <i class="fold iconfont icon-right"></i>
            Redis
            <small>(2)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="대용량 트래픽&lt;---&gt;Redis&lt;---&gt;Kafka">
            
            Kafka
            <small>(1)</small>
        </div>
        
    </li>

                
                    
    <li>
        <div data-rel="대용량 트래픽&lt;---&gt;Redis&lt;---&gt;WebFlux">
            <i class="fold iconfont icon-right"></i>
            WebFlux
            <small>(1)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="대용량 트래픽&lt;---&gt;Redis&lt;---&gt;WebFlux&lt;---&gt;접근자 대기열">
            
            접근자 대기열
            <small>(1)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

                
            </ul>
        
    </li>

                
            </ul>
        
    </li>

            
        
    
        
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
            
    </div>
    <div>
        
            <a class="about  hasFriend  site_url"
               
               href="/about">About</a>
        
        <a style="width: 50%"
                
                                           class="friends">Friends</a>
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="69">

<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        Links
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="http://yelog.org/">叶落阁</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="search shortcut key i"></i>
            <div class="right-title">All</div>
            <i class="iconfont icon-file-tree" data-title="switch to outline view shortcut key w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="return"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="case sensitive"></i>
            <i class="iconfont icon-tag" data-title="label"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">outline</div>
            <i class="iconfont icon-list" data-title="switch to article list"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
    </div>

</div>

    
    <nav id="title-list-nav">
        
        
        <a  class="All NoSQL Redis "
           href="/2025/12/28/NoSQL/CACHE_STRATEGY/CacheStrategy/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="캐시 전략">캐시 전략</span>
            <span class="post-date" title="2025-12-28 07:47:42">2025/12/28</span>
        </a>
        
        
        <a  class="All CI-CD AWS EKS Kubernetes Docker "
           href="/2025/08/15/CI-CD/AWS_EKS_CICD/aws_eks_cicd/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="AWS EKS 서버 배포 - CI/CD">AWS EKS 서버 배포 - CI/CD</span>
            <span class="post-date" title="2025-08-15 07:47:42">2025/08/15</span>
        </a>
        
        
        <a  class="All DB MySql Collation "
           href="/2025/07/23/DB/Mysql/Collation/Collation/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Mysql - Collation">Mysql - Collation</span>
            <span class="post-date" title="2025-07-23 07:47:42">2025/07/23</span>
        </a>
        
        
        <a  class="All Network "
           href="/2025/07/15/NETWORK/introduction/Network-Introduction/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="네트워크 - 구조 및 공유기 원리">네트워크 - 구조 및 공유기 원리</span>
            <span class="post-date" title="2025-07-15 07:47:42">2025/07/15</span>
        </a>
        
        
        <a  class="All Kafka "
           href="/2025/07/06/KAFKA/introduction/kafka_introduction/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="카프카 개념 및 실전">카프카 개념 및 실전</span>
            <span class="post-date" title="2025-07-06 07:47:42">2025/07/06</span>
        </a>
        
        
        <a  class="All "
           href="/2025/06/27/AWS/ImageResizing/imageTest/"
           data-tag=""
           data-author="" >
            <span class="post-title" title=""></span>
            <span class="post-date" title="2025-06-27 20:10:06">2025/06/27</span>
        </a>
        
        
        <a  class="All AWS Image Resizing "
           href="/2025/06/26/AWS/ImageResizing/aws-image-resizing/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="AWS Image Resizing 구현하기">AWS Image Resizing 구현하기</span>
            <span class="post-date" title="2025-06-26 07:47:42">2025/06/26</span>
        </a>
        
        
        <a  class="All Elastic Search "
           href="/2025/06/16/ELASTIC_SEARCH/introduction/elasticsearch-introduction/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Elastic Search 검색 활용기">Elastic Search 검색 활용기</span>
            <span class="post-date" title="2025-06-16 07:47:42">2025/06/16</span>
        </a>
        
        
        <a  class="All Flink Real Time Kafka "
           href="/2025/04/05/FLINK/introduction/Flink-Introduction/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Flink 이용해서 실시간 데이터 스트림 처리 해보기">Flink 이용해서 실시간 데이터 스트림 처리 해보기</span>
            <span class="post-date" title="2025-04-05 07:47:42">2025/04/05</span>
        </a>
        
        
        <a  class="All Kafka idempotent "
           href="/2024/12/23/KAFKA/idempotent/Kafka_idempotent/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="카프카 멱등성 및 이벤트 일관성 보장하기">카프카 멱등성 및 이벤트 일관성 보장하기</span>
            <span class="post-date" title="2024-12-23 07:47:42">2024/12/23</span>
        </a>
        
        
        <a  class="All MSA Payment Kafka EDA CQRS "
           href="/2024/12/16/MSA/paymentMsa/MSA_Payment_Project_3/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="결제 시스템으로 알아보는 MSA 3 - 쿼리 문제">결제 시스템으로 알아보는 MSA 3 - 쿼리 문제</span>
            <span class="post-date" title="2024-12-16 07:47:42">2024/12/16</span>
        </a>
        
        
        <a  class="All MSA Payment Kafka EDA Saga Axon "
           href="/2024/12/15/MSA/paymentMsa/MSA_Payment_Project_2/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="결제 시스템으로 알아보는 MSA 2 - 분산 트랜잭션 구현">결제 시스템으로 알아보는 MSA 2 - 분산 트랜잭션 구현</span>
            <span class="post-date" title="2024-12-15 07:47:42">2024/12/15</span>
        </a>
        
        
        <a  class="All MSA Payment Kafka EDA "
           href="/2024/12/14/MSA/paymentMsa/MSA_Payment_Project_1/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="결제 시스템으로 알아보는 MSA 1 - 기본 설명">결제 시스템으로 알아보는 MSA 1 - 기본 설명</span>
            <span class="post-date" title="2024-12-14 07:47:42">2024/12/14</span>
        </a>
        
        
        <a  class="All 대용량 트래픽 EDA Payment Redis Kafka "
           href="/2024/12/13/HIGH_VOLUME_TRAFFIC/PaymentEDA/PaymentEDA/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="결제 시스템으로 알아보는 EDA 시스템">결제 시스템으로 알아보는 EDA 시스템</span>
            <span class="post-date" title="2024-12-13 07:47:42">2024/12/13</span>
        </a>
        
        
        <a  class="All DB Mysql optimizing "
           href="/2024/12/06/DB/Mysql/optimizing/IndexDiveOptimizaiton/IndexDiveOptimizaiton/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Index Dive 최적화">Index Dive 최적화</span>
            <span class="post-date" title="2024-12-06 07:47:42">2024/12/06</span>
        </a>
        
        
        <a  class="All JAVA Spring Payment junit5 Mockito "
           href="/2024/12/03/JAVA/TEST/PaymentTesting/PaymentTesting2/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="결제 Testing - 2">결제 Testing - 2</span>
            <span class="post-date" title="2024-12-03 15:50:00">2024/12/03</span>
        </a>
        
        
        <a  class="All JAVA Spring Payment junit5 Mockito "
           href="/2024/12/02/JAVA/TEST/PaymentTesting/PaymentTesting1/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="결제 Testing - 1">결제 Testing - 1</span>
            <span class="post-date" title="2024-12-02 15:50:00">2024/12/02</span>
        </a>
        
        
        <a  class="All 대용량 트래픽 Redis WebFlux 접근자 대기열 "
           href="/2024/11/28/HIGH_VOLUME_TRAFFIC/AccessorQueuingSystem/AccessorQueuingSystem/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="대용량 트래픽 - 접근자 대기열 시스템 만들기">대용량 트래픽 - 접근자 대기열 시스템 만들기</span>
            <span class="post-date" title="2024-11-28 07:47:42">2024/11/28</span>
        </a>
        
        
        <a  class="All 대용량 트래픽 Redis Kafka "
           href="/2024/11/22/HIGH_VOLUME_TRAFFIC/CreateCoupon/CreateCoupon/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="대용량 트래픽 - 선착순 쿠폰 등록 With Kafka, Redis">대용량 트래픽 - 선착순 쿠폰 등록 With Kafka, Redis</span>
            <span class="post-date" title="2024-11-22 07:47:42">2024/11/22</span>
        </a>
        
        
        <a  class="All NoSQL Redis RateLimiter "
           href="/2024/11/19/NoSQL/Redis/RateLimiter/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Request Rate Limiter 구현하기">Request Rate Limiter 구현하기</span>
            <span class="post-date" title="2024-11-19 07:47:42">2024/11/19</span>
        </a>
        
        
        <a  class="All CI-CD GitHubActions "
           href="/2024/10/20/CI-CD/GitHunActions/GitHubActionsCICDWithSpringBoot6/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="GitHubActions CICD With SpringBoot - 6">GitHubActions CICD With SpringBoot - 6</span>
            <span class="post-date" title="2024-10-20 07:47:42">2024/10/20</span>
        </a>
        
        
        <a  class="All CI-CD GitHubActions "
           href="/2024/10/19/CI-CD/GitHunActions/GitHubActionsCICDWithSpringBoot5/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="GitHubActions CICD With SpringBoot - 5">GitHubActions CICD With SpringBoot - 5</span>
            <span class="post-date" title="2024-10-19 07:47:42">2024/10/19</span>
        </a>
        
        
        <a  class="All CI-CD GitHubActions "
           href="/2024/10/18/CI-CD/GitHunActions/GitHubActionsCICDWithSpringBoot4/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="GitHubActions CICD With SpringBoot - 4">GitHubActions CICD With SpringBoot - 4</span>
            <span class="post-date" title="2024-10-18 07:47:42">2024/10/18</span>
        </a>
        
        
        <a  class="All CI-CD GitHubActions "
           href="/2024/10/17/CI-CD/GitHunActions/GitHubActionsCICDWithSpringBoot3/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="GitHubActions CICD With SpringBoot - 3">GitHubActions CICD With SpringBoot - 3</span>
            <span class="post-date" title="2024-10-17 07:47:42">2024/10/17</span>
        </a>
        
        
        <a  class="All CI-CD GitHubActions "
           href="/2024/10/14/CI-CD/GitHunActions/GitHubActionsCICDWithSpringBoot2/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="GitHubActions CICD With SpringBoot - 2">GitHubActions CICD With SpringBoot - 2</span>
            <span class="post-date" title="2024-10-14 07:47:42">2024/10/14</span>
        </a>
        
        
        <a  class="All CI-CD GitHubActions "
           href="/2024/10/14/CI-CD/GitHunActions/GitHubActionsCICDWithSpringBoot1/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="GitHubActions CICD With SpringBoot - 1">GitHubActions CICD With SpringBoot - 1</span>
            <span class="post-date" title="2024-10-14 07:47:42">2024/10/14</span>
        </a>
        
        
        <a  class="All DB Mysql Paging "
           href="/2024/10/06/DB/Mysql/PagingQuery/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Paging Query 성능 개선 및 처리 방법 - 튜닝편">Paging Query 성능 개선 및 처리 방법 - 튜닝편</span>
            <span class="post-date" title="2024-10-06 07:47:42">2024/10/06</span>
        </a>
        
        
        <a  class="All DB Mysql DBCP "
           href="/2024/10/02/DB/Mysql/mysqlDBCP/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="DBCP 설정 방법">DBCP 설정 방법</span>
            <span class="post-date" title="2024-10-02 07:47:42">2024/10/02</span>
        </a>
        
        
        <a  class="All JAVA Object "
           href="/2024/08/24/JAVA/Object/InheritanceComposition2/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="상속과 합성 이야기-2">상속과 합성 이야기-2</span>
            <span class="post-date" title="2024-08-24 15:50:00">2024/08/24</span>
        </a>
        
        
        <a  class="All JAVA Object "
           href="/2024/08/23/JAVA/Object/InheritanceComposition1/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="상속과 합성 이야기-1">상속과 합성 이야기-1</span>
            <span class="post-date" title="2024-08-23 15:50:00">2024/08/23</span>
        </a>
        
        
        <a  class="All JAVA Payment "
           href="/2024/08/06/JAVA/Payment/PaymentTransactionalOutboxpattern/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="결제 시스템 구축 - 5">결제 시스템 구축 - 5</span>
            <span class="post-date" title="2024-08-06 15:50:00">2024/08/06</span>
        </a>
        
        
        <a  class="All JAVA Payment "
           href="/2024/08/05/JAVA/Payment/PaymentRetry/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="결제 시스템 구축 - 4">결제 시스템 구축 - 4</span>
            <span class="post-date" title="2024-08-05 15:50:00">2024/08/05</span>
        </a>
        
        
        <a  class="All JAVA Payment "
           href="/2024/07/28/JAVA/Payment/BuildingPaymentSystem/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="결제 시스템 구축 - 1">결제 시스템 구축 - 1</span>
            <span class="post-date" title="2024-07-28 15:50:00">2024/07/28</span>
        </a>
        
        
        <a  class="All JAVA Payment "
           href="/2024/07/28/JAVA/Payment/PaymentCheckOut/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="결제 시스템 구축 - 2">결제 시스템 구축 - 2</span>
            <span class="post-date" title="2024-07-28 15:50:00">2024/07/28</span>
        </a>
        
        
        <a  class="All JAVA Payment "
           href="/2024/07/28/JAVA/Payment/PaymentConfirm/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="결제 시스템 구축 - 3">결제 시스템 구축 - 3</span>
            <span class="post-date" title="2024-07-28 15:50:00">2024/07/28</span>
        </a>
        
        
        <a  class="All "
           href="/2024/05/31/hello-world/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Hello World">Hello World</span>
            <span class="post-date" title="2024-05-31 22:32:19">2024/05/31</span>
        </a>
        
        
        <a  class="All "
           href="/2024/05/31/README/"
           data-tag=""
           data-author="" >
            <span class="post-title" title=""></span>
            <span class="post-date" title="2024-05-31 22:32:19">2024/05/31</span>
        </a>
        
        
        <a  class="All JAVA Security "
           href="/2024/05/30/JAVA/Security/AnonymousAuthenticationFilter/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="AnonymousAuthenticationFilter">AnonymousAuthenticationFilter</span>
            <span class="post-date" title="2024-05-30 10:04:43">2024/05/30</span>
        </a>
        
        
        <a  class="All "
           href="/2024/02/01/HIGH_VOLUME_TRAFFIC/AccessorQueuingSystem2/AccessorQueuingSystem/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="패스트캠퍼스 9개 프로젝트로 경험하는 대용량 트래픽 &amp; 데이터 처리 초격차 패키지 Online. 수강">패스트캠퍼스 9개 프로젝트로 경험하는 대용량 트래픽 &amp; 데이터 처리 초격차 패키지 Online. 수강</span>
            <span class="post-date" title="2024-02-01 00:00:00">2024/02/01</span>
        </a>
        
        
        <a  class="All Authentication JWT "
           href="/2021/11/27/AUTHTICATION/JWT/jwt/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="JWT (JSON Web Token) 이해하기">JWT (JSON Web Token) 이해하기</span>
            <span class="post-date" title="2021-11-27 07:47:42">2021/11/27</span>
        </a>
        
        
        <a  class="All Authentication Oauth "
           href="/2021/11/27/AUTHTICATION/OAUTH/oauth/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="OAUTH 2.0 이해하기">OAUTH 2.0 이해하기</span>
            <span class="post-date" title="2021-11-27 07:47:42">2021/11/27</span>
        </a>
        
        
        <a  class="All JAVA HTTP FeignClient "
           href="/2021/11/08/JAVA/HTTP/FeignClient/FeignClient/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="FeignClient 활용도">FeignClient 활용도</span>
            <span class="post-date" title="2021-11-08 10:04:43">2021/11/08</span>
        </a>
        
        
        <a  class="All JAVA SpringBatch "
           href="/2021/11/04/JAVA/Batch/SpringBatch5/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Spring Batch - Chunk 5">Spring Batch - Chunk 5</span>
            <span class="post-date" title="2021-11-04 07:47:42">2021/11/04</span>
        </a>
        
        
        <a  class="All JAVA SpringBatch "
           href="/2021/10/30/JAVA/Batch/SpringBatch4/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Spring Batch - Flow 4">Spring Batch - Flow 4</span>
            <span class="post-date" title="2021-10-30 07:47:42">2021/10/30</span>
        </a>
        
        
        <a  class="All JAVA SpringBatch "
           href="/2021/10/24/JAVA/Batch/SpringBatch3/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Spring Batch - 메타데이터 스키마 3">Spring Batch - 메타데이터 스키마 3</span>
            <span class="post-date" title="2021-10-24 07:47:42">2021/10/24</span>
        </a>
        
        
        <a  class="All JAVA SpringBatch "
           href="/2021/10/19/JAVA/Batch/SpringBatch2/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Spring Batch - Job, Step 2">Spring Batch - Job, Step 2</span>
            <span class="post-date" title="2021-10-19 07:47:42">2021/10/19</span>
        </a>
        
        
        <a  class="All JAVA SpringBatch "
           href="/2021/10/17/JAVA/Batch/SpringBatch1/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Spring Batch 1">Spring Batch 1</span>
            <span class="post-date" title="2021-10-17 07:47:42">2021/10/17</span>
        </a>
        
        
        <a  class="All JAVA SpringCloudConfig "
           href="/2021/09/13/JAVA/SpringCloudConfig/spring-cloud-config4/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="비대칭키를 이용한 application.yml 설정값 암호화">비대칭키를 이용한 application.yml 설정값 암호화</span>
            <span class="post-date" title="2021-09-13 07:47:45">2021/09/13</span>
        </a>
        
        
        <a  class="All JAVA SpringCloudConfig "
           href="/2021/09/13/JAVA/SpringCloudConfig/spring-cloud-config3/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Spring Cloud Bus">Spring Cloud Bus</span>
            <span class="post-date" title="2021-09-13 07:47:44">2021/09/13</span>
        </a>
        
        
        <a  class="All JAVA SpringCloudConfig "
           href="/2021/09/13/JAVA/SpringCloudConfig/spring-cloud-config2/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Spring Boot Actuator">Spring Boot Actuator</span>
            <span class="post-date" title="2021-09-13 07:47:43">2021/09/13</span>
        </a>
        
        
        <a  class="All JAVA SpringCloudConfig "
           href="/2021/09/13/JAVA/SpringCloudConfig/spring-cloud-config/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Spring Cloud Config">Spring Cloud Config</span>
            <span class="post-date" title="2021-09-13 07:47:42">2021/09/13</span>
        </a>
        
        
        <a  class="All JAVA Transaction "
           href="/2021/03/14/JAVA/Transaction/multi-transaction/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java Multi-Transaction 관리">Java Multi-Transaction 관리</span>
            <span class="post-date" title="2021-03-14 07:47:42">2021/03/14</span>
        </a>
        
        
        <a  class="All JAVA Validator "
           href="/2020/12/18/JAVA/VALIDATOR/validator/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Java Validator 관리">Java Validator 관리</span>
            <span class="post-date" title="2020-12-18 07:47:42">2020/12/18</span>
        </a>
        
        
        <a  class="All JAVA Security "
           href="/2020/11/19/JAVA/Security/SessionManagementFilterAndConcurrentSessionFilter/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="SessionManagementFilterAndConcurrentSessionFilter">SessionManagementFilterAndConcurrentSessionFilter</span>
            <span class="post-date" title="2020-11-19 18:02:23">2020/11/19</span>
        </a>
        
        
        <a  class="All JAVA Security "
           href="/2020/11/14/JAVA/Security/RememberMeAuthenticationFilter/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="RememberMeAuthenticationFilter">RememberMeAuthenticationFilter</span>
            <span class="post-date" title="2020-11-14 07:40:06">2020/11/14</span>
        </a>
        
        
        <a  class="All JAVA Security "
           href="/2020/11/13/JAVA/Security/UsernamePasswordAuthenticationFilter/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="UsernamePasswordAuthenticationFilter">UsernamePasswordAuthenticationFilter</span>
            <span class="post-date" title="2020-11-13 08:51:13">2020/11/13</span>
        </a>
        
        
        <a  class="All CI-CD Jenkins "
           href="/2020/11/09/CI-CD/Jenkins/JenkinsGitLabConnect/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Jenkins_GitLab_연동">Jenkins_GitLab_연동</span>
            <span class="post-date" title="2020-11-09 07:47:42">2020/11/09</span>
        </a>
        
        
        <a  class="All CI-CD Jenkins "
           href="/2020/11/08/CI-CD/Jenkins/JenkinsGitLabSshConnect/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="젠킨스와 GitLab ssh 연동하기">젠킨스와 GitLab ssh 연동하기</span>
            <span class="post-date" title="2020-11-08 07:47:42">2020/11/08</span>
        </a>
        
        
        <a  class="All JAVA JPA "
           href="/2020/11/08/JAVA/JPA/eagerJpqlNplus1/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="eagerJpqlNplus1">eagerJpqlNplus1</span>
            <span class="post-date" title="2020-11-08 07:47:42">2020/11/08</span>
        </a>
        
        
        <a  class="All JAVA SpringBootAndSecurityAndJWT "
           href="/2020/11/08/JAVA/SpringBootAndSecurityAndJWT/spring-boot-security-jwt-social/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Spring Boot 를 이용해 JWT + Social 로그인 처리 - Authorization Server (일반 로그인)">Spring Boot 를 이용해 JWT + Social 로그인 처리 - Authorization Server (일반 로그인)</span>
            <span class="post-date" title="2020-11-08 07:47:42">2020/11/08</span>
        </a>
        
        
        <a  class="All JAVA SpringBootAndSecurityAndJWT "
           href="/2020/11/08/JAVA/SpringBootAndSecurityAndJWT/spring-boot-security-jwt-social2/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Spring Boot 를 이용해 JWT + Social 로그인 처리 - Authorization Server (Social 로그인)">Spring Boot 를 이용해 JWT + Social 로그인 처리 - Authorization Server (Social 로그인)</span>
            <span class="post-date" title="2020-11-08 07:47:42">2020/11/08</span>
        </a>
        
        
        <a  class="All JAVA SpringBootAndSecurityAndJWT "
           href="/2020/11/08/JAVA/SpringBootAndSecurityAndJWT/spring-boot-security-jwt-social3/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Spring Boot 를 이용해 JWT + Social 로그인 처리 - Resource Server">Spring Boot 를 이용해 JWT + Social 로그인 처리 - Resource Server</span>
            <span class="post-date" title="2020-11-08 07:47:42">2020/11/08</span>
        </a>
        
        
        <a  class="All J Jenkins "
           href="/2020/11/07/JAVA/Security/JKSGenerate/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="JKSGenerate">JKSGenerate</span>
            <span class="post-date" title="2020-11-07 13:46:21">2020/11/07</span>
        </a>
        
        
        <a  class="All CI-CD Jenkins "
           href="/2020/11/07/CI-CD/Jenkins/JenkinsInstall/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="쿠버네티스 환경 구성">쿠버네티스 환경 구성</span>
            <span class="post-date" title="2020-11-07 07:47:42">2020/11/07</span>
        </a>
        
        
        <a  class="All DB Mysql "
           href="/2020/11/07/DB/Mysql/mysqlReplicationSetting/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Mysql_Replication_설정">Mysql_Replication_설정</span>
            <span class="post-date" title="2020-11-07 07:47:42">2020/11/07</span>
        </a>
        
        
        <a  class="All KUBERNETES "
           href="/2020/11/07/KUBERNETES/%EC%89%BD%EA%B2%8C_%EC%8B%9C%EC%9E%91%ED%95%98%EB%8A%94_%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4/%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4_%ED%99%98%EA%B2%BD_%EA%B5%AC%EC%84%B1/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Jenkins_설치">Jenkins_설치</span>
            <span class="post-date" title="2020-11-07 07:47:42">2020/11/07</span>
        </a>
        
        
        <a  class="All R "
           href="/2020/10/17/R/RServerInstall/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="RServer 설치">RServer 설치</span>
            <span class="post-date" title="2020-10-17 07:47:42">2020/10/17</span>
        </a>
        
        
        <a  class="All JavaScript Webpack "
           href="/2020/10/17/JAVASCRIPT/Webpack/devtool/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="WebPack - DevTool">WebPack - DevTool</span>
            <span class="post-date" title="2020-10-17 07:47:42">2020/10/17</span>
        </a>
        
        
        <a  class="All "
           href="/2018/12/02/%EB%A9%B4%EC%A0%91%EC%A4%80%EB%B9%84/test/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="그냥... 잡다한 지식 모음집">그냥... 잡다한 지식 모음집</span>
            <span class="post-date" title="2018-12-02 15:50:00">2018/12/02</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="Toggle full screen shortcut key s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-JAVA/SpringBootAndSecurityAndJWT/spring-boot-security-jwt-social3" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">Spring Boot 를 이용해 JWT + Social 로그인 처리 - Resource Server</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="JAVA">JAVA</a> > 
            
            <a  data-rel="JAVA&lt;---&gt;SpringBootAndSecurityAndJWT">SpringBootAndSecurityAndJWT</a>
            
        </span>
        
        
    </div>
    <div class="article-meta">
        
            Created At : <time class="date" title='Updated At: 2024-05-31 22:32:19'>2020-11-08 07:47</time>
        
    </div>
    <div class="article-meta">
        
        
        <span id="busuanzi_container_page_pv">
            Views 👀 :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Spring-Boot-%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%B4-JWT-%EB%B0%8F-Social-%EC%9D%B8%EC%A6%9D-%EC%9D%B8%EA%B0%80-%EC%B2%98%EB%A6%AC"><span class="toc-text">Spring Boot 를 이용해 JWT 및 Social 인증, 인가 처리</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Resource-Server-%EA%B5%AC%ED%98%84"><span class="toc-text">Resource Server 구현</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Spring-Security-%EC%84%A4%EC%A0%95"><span class="toc-text">Spring Security 설정</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Spring-Security-%EC%9D%B8%EA%B0%80-%EC%B2%98%EB%A6%AC"><span class="toc-text">Spring Security 인가 처리</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Role-%EB%B0%8F-Resource-%ED%85%8C%EC%9D%B4%EB%B8%94-Insert-%ED%95%98%EA%B8%B0"><span class="toc-text">Role 및 Resource 테이블 Insert 하기</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Spring-Security-FilterInvocationSecurityMetadataSource-%EA%B5%AC%ED%98%84%ED%95%98%EA%B8%B0"><span class="toc-text">Spring Security FilterInvocationSecurityMetadataSource 구현하기</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Spring-Security-UrlResourcesMapFactoryBean-%EA%B5%AC%ED%98%84%ED%95%98%EA%B8%B0"><span class="toc-text">Spring Security UrlResourcesMapFactoryBean 구현하기</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EC%9D%B8%EA%B0%80%EC%B2%98%EB%A6%AC-%EB%8F%99%EC%A0%81-%EB%B0%98%EC%98%81%ED%95%98%EA%B8%B0"><span class="toc-text">인가처리 동적 반영하기</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EC%9D%B8%EA%B0%80%EC%B2%98%EB%A6%AC-PermitAllFilter-%EA%B5%AC%ED%98%84%ED%95%98%EA%B8%B0"><span class="toc-text">인가처리 PermitAllFilter 구현하기</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EC%9D%B8%EA%B0%80%EC%B2%98%EB%A6%AC-%EA%B3%84%EC%B8%B5-%EA%B6%8C%ED%95%9C-%EA%B5%AC%ED%98%84%ED%95%98%EA%B8%B0"><span class="toc-text">인가처리 계층 권한 구현하기</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EB%A7%88%EC%B9%98%EB%A9%B4%EC%84%9C"><span class="toc-text">마치면서</span></a></li></ol></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Spring-Boot-를-이용해-JWT-및-Social-인증-인가-처리"><a href="#Spring-Boot-를-이용해-JWT-및-Social-인증-인가-처리" class="headerlink" title="Spring Boot 를 이용해 JWT 및 Social 인증, 인가 처리"></a>Spring Boot 를 이용해 JWT 및 Social 인증, 인가 처리</h2><h3 id="Resource-Server-구현"><a href="#Resource-Server-구현" class="headerlink" title="Resource Server 구현"></a>Resource Server 구현</h3><p>인증 서버 통해 JWT 토큰을 발급 받게 되었다면 이 토큰을 이용해 원하는 Resource 로 접근해서 데이터를 받는 역활을 하는 Resource 서버를 구축 할려고 합니다.</p>
<p>Resource 서버로 요청 하게 된다면 Authorization 서버와 달리 </p>
<ol>
<li>요청 받은 JWT Token 을 검증 한다.</li>
<li>접속한 Resource 에 대한 권한이 올바른지 체크한다.</li>
<li>모든 인증, 인가 처리가 완료된다면 해당 데이터를 조회해 응답 한다.</li>
</ol>
<p>이제부터 하나하나씩 알아봅시다.</p>
<h3 id="Spring-Security-설정"><a href="#Spring-Security-설정" class="headerlink" title="Spring Security 설정"></a>Spring Security 설정</h3><p>SecurityConfig.java</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">private final JwtAuthenticationFilter jwtAuthenticationFilter;</span><br><span class="line"></span><br><span class="line">@Override</span><br><span class="line"><span class="code">    protected void configure(HttpSecurity http) throws Exception &#123;</span></span><br><span class="line"><span class="code">        http.sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS).and()</span></span><br><span class="line"><span class="code">                .csrf().disable()</span></span><br><span class="line"><span class="code">                .cors().disable()</span></span><br><span class="line"><span class="code">                .formLogin().disable()</span></span><br><span class="line"><span class="code">                .logout().disable()</span></span><br><span class="line"><span class="code">                .httpBasic().disable()</span></span><br><span class="line"><span class="code">                .authorizeRequests()</span></span><br><span class="line"><span class="code">                .antMatchers(HttpMethod.OPTIONS, &quot;/**&quot;).permitAll()</span></span><br><span class="line"><span class="code">                .anyRequest().authenticated().and()</span></span><br><span class="line"><span class="code">                .exceptionHandling()</span></span><br><span class="line"><span class="code">                .authenticationEntryPoint(new HttpStatusEntryPoint(HttpStatus.UNAUTHORIZED));</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">        http.addFilterBefore(jwtAuthenticationFilter, UsernamePasswordAuthenticationFilter.class);</span></span><br><span class="line"><span class="code">        http.addFilterBefore(customFilterSecurityInterceptor(), FilterSecurityInterceptor.class);</span></span><br><span class="line"><span class="code">    &#125;</span></span><br></pre></td></tr></table></figure>
<p>Authorization Server 에서 설정한 것과 크게 다르지 않습니다.</p>
<p>다른 부분이 있다면</p>
<p><code>http.addFilterBefore(jwtAuthenticationFilter, UsernamePasswordAuthenticationFilter.class);</code></p>
<p>Spring Security 에서는 인증 및 인가 처리시 여러가지 Filter 를 거친다고 했습니다.</p>
<p>그 중 UsernamePasswordAuthenticationFilter 는 Spring Security 의 인증 처리 하는 대표적인 Filter 입니다. 즉 입력된 ID&#x2F;PASSWORD 를 통해 올바른 회원인지 체크 하는 단계 입니다.</p>
<p>해당 소스는 UsernamePasswordAuthenticationFilter filter 거치기 전에 자체적으로 만든 JwtAuthenticationFilter 클래스를 거치도록 하겠다는 의미 입니다.</p>
<p>JwtAuthenticationFilter 는 응답 받은 JWT Token 을 올바른지 검증하고 올바른다면 Spring Security 인증 객체를 생성해서 SecurityContextHolder 에 저장 할려고 합니다.</p>
<p><code>http.addFilterBefore(customFilterSecurityInterceptor(), FilterSecurityInterceptor.class);</code></p>
<p>FilterSecurityInterceptor 클래스는 Spring Security Filter 중 맨 마지막에 위치한 사용자의 권한 체크를 하는 Filter 입니다.</p>
<p>이부분도 역시 FilterSecurityInterceptor 앞에 위치해서 customFilterSecurityInterceptor 메소드를 호출 시켜</p>
<p>자체적으로 FilterSecurityInterceptor 클래스를 extend 한 PermitAllFilter 클래스를 만든 후 사용 할 예정입니다. (뒤에 ‘ 인가처리 허용 필터 구현하기’ 에서 자세히 설명 계획)</p>
<h3 id="Spring-Security-인가-처리"><a href="#Spring-Security-인가-처리" class="headerlink" title="Spring Security 인가 처리"></a>Spring Security 인가 처리</h3><p>보통 서비스 운영하는 업체라면 유저 권한에 따라 해당 페이지 접속이 제한 되는 부분이 있을겁니다.</p>
<p>예를들어 서비스 운영자만 사용할 수 있는 ADMIN 페이지가 대표적 입니다. </p>
<p>ADMIN 페이지는 반드시 해당 서비스 직원들에게만 권한을 부여하고 그외 고객들은 접속 하면 안됩니다.</p>
<p>이를 구현하기 위해서 각각 페이지마다 소스 코드로 권한 관련 로직을 작성 하는것은 번거로운 일이다.</p>
<p>매번 해당 API 가 ADMIN 만 접속이 가능하도록 변경 사항이 있다면 코드를 수정하고 서버를 재기동 해야 합니다.</p>
<p>관리자 페이지에서 해당 API 접속 권한을 변경만으로 코드 수정 및 서버 재기동 할 필요없이 동적으로 관리가 가능하도록 해야 합니다.</p>
<p>Spring Security 에서는 편리하게 동적으로 권한을 관리 할 수 있도록 도와줍니다.</p>
<p>즉 해당 API 에서는 일반 유저에게만 접속이 가능하도록 하다가 변경상황으로 인해 ADMIN 유저에게만 접속이 가능하도록 실시간으로 변경이 가능 합니다.</p>
<p>실제 서비스 업체에서는</p>
<ol>
<li>회원관리</li>
<li>권한관리</li>
<li>자원관리</li>
</ol>
<p>이 3가지가 동적으로 관리가 가능 하도록 시스템이 구축되어 있어야 합니다.</p>
<p>이번 시간에는 3가지 기능을 프론트단에서는 구현을 안하지만 백엔드에서 어떻게 구성 해야 하는지 알아보는 시간을 갖도록 하겠습니다.</p>
<p>Spring Security 에서는 권한계층 관리 할 수 있도록 대표적으로 2가지 있는데</p>
<ol>
<li>URL 요청시 인가처리</li>
<li>메소드 호출시 인가처리</li>
</ol>
<p>이 2가지를 제공해주며 우리는 보편적으로 사용하는 1번 URL 요청시 인가처리에 대해 알아보겠습니다.</p>
<h3 id="Role-및-Resource-테이블-Insert-하기"><a href="#Role-및-Resource-테이블-Insert-하기" class="headerlink" title="Role 및 Resource 테이블 Insert 하기"></a>Role 및 Resource 테이블 Insert 하기</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO <span class="code">`role`</span> (<span class="code">`role_no`</span>, <span class="code">`name`</span>, <span class="code">`use_yn`</span>, <span class="code">`created_at`</span>, <span class="code">`updated_at`</span>) VALUES</span><br><span class="line"><span class="code">	(1, &#x27;ROLE_SUPER_ADMIN&#x27;, &#x27;Y&#x27;, &#x27;2019-08-22 09:52:36&#x27;, NULL),</span></span><br><span class="line"><span class="code">	(2, &#x27;ROLE_ADMIN&#x27;, &#x27;Y&#x27;, &#x27;2019-08-22 09:52:36&#x27;, NULL),</span></span><br><span class="line"><span class="code">	(3, &#x27;ROLE_CLIENT&#x27;, &#x27;Y&#x27;, &#x27;2019-08-22 09:52:37&#x27;, NULL),</span></span><br><span class="line"><span class="code">	(4, &#x27;ROLE_USER&#x27;, &#x27;Y&#x27;, &#x27;2019-08-22 09:52:38&#x27;, NULL);</span></span><br><span class="line"><span class="code"></span></span><br><span class="line">INSERT INTO <span class="code">`resources`</span> (<span class="code">`resource_no`</span>, <span class="code">`name`</span>, <span class="code">`http_method`</span>, <span class="code">`order_num`</span>, <span class="code">`type`</span>, <span class="code">`use_yn`</span>, <span class="code">`created_at`</span>, <span class="code">`updated_at`</span>) VALUES</span><br><span class="line"><span class="code">	(1, &#x27;/api/boards&#x27;, NULL, 1, &#x27;url&#x27;, &#x27;N&#x27;, &#x27;2021-09-25 20:08:45&#x27;, NULL);</span></span><br><span class="line"><span class="code">	</span></span><br><span class="line"><span class="code"></span></span><br><span class="line">INSERT INTO <span class="code">`role_resources_mapping`</span> (<span class="code">`resource_no`</span>, <span class="code">`role_no`</span>, <span class="code">`use_yn`</span>, <span class="code">`created_at`</span>, <span class="code">`updated_at`</span>) VALUES</span><br><span class="line"><span class="code">	(1, 1, &#x27;Y&#x27;, &#x27;2020-11-28 16:27:12&#x27;, NULL);</span></span><br><span class="line"><span class="code">	</span></span><br><span class="line"><span class="code">	</span></span><br><span class="line"><span class="code">INSERT INTO `role_hierarchy` (`role_hierarchy_no`, `parent_name`, `child_name`) VALUES</span></span><br><span class="line"><span class="code">	(1, &#x27;&#x27;, &#x27;ROLE_SUPER_ADMIN&#x27;),</span></span><br><span class="line"><span class="code">	(2, &#x27;ROLE_SUPER_ADMIN&#x27;, &#x27;ROLE_ADMIN&#x27;),</span></span><br><span class="line"><span class="code">	(3, &#x27;ROLE_ADMIN&#x27;, &#x27;ROLE_CLIENT&#x27;),</span></span><br><span class="line"><span class="code">	(4, &#x27;ROLE_CLIENT&#x27;, &#x27;ROLE_USER&#x27;);</span></span><br></pre></td></tr></table></figure>

<p>인가 처리시 사용되는 DB 데이터 입니다.</p>
<p>role 테이블에서는 </p>
<ul>
<li>ROLE_SUPER_ADMIN</li>
<li>ROLE_ADMIN</li>
<li>ROLE_CLIENT</li>
<li>ROLE_USER</li>
</ul>
<p>권한 목록을 추가 합니다.</p>
<p>그리고 resource 테이블에서는 어떤 자원을 url 방식으로 저장 합니다.</p>
<p>한 resource 자원 정보는 어떤 role 과 매칭 하는지 role_resources_mapping 테이블로 지정 합니다.</p>
<p>role_hierarchy 테이블은 role 계층 정보 입니다.</p>
<p>만약 해당 resource 정보의 권한이 ‘ROLE_CLIENT’ 이라면 그보다 계층이 높은 ‘ROLE_SUPER_ADMIN’ 통해 유저가 해당 자원을 접속 할 경우 권한을 통과 할수 있도록 설정 할 수 있는 테이블 입니다.</p>
<h3 id="Spring-Security-FilterInvocationSecurityMetadataSource-구현하기"><a href="#Spring-Security-FilterInvocationSecurityMetadataSource-구현하기" class="headerlink" title="Spring Security FilterInvocationSecurityMetadataSource 구현하기"></a>Spring Security FilterInvocationSecurityMetadataSource 구현하기</h3><p>Spring Security 에서는 권한 체크시 요청정보과 매칭되는 권한정보 추출 역활을 하는 SecurityMetadataSource 자식 클래스인 FilterInvocationSecurityMetadataSource(URL 자원 정보 체크 담당) 클래스에 구현되어 있습니다.</p>
<p>자세한 내용은 Spring Security 인가 처리편에 자세히 설명 할 예정입니다.</p>
<p>간단히 설명하자면 Spring Security 에서 URL 자원 정보 통해 권한 체크시 요청정보과 매칭되는 권한정보 추출 역활을 하는 FilterInvocationSecurityMetadataSource 를 Custom 해서 구현 할겁니다.</p>
<p>즉 기존에는 직접 소스코드(Spring Security 설정)에서 입력한 권한 정보 및 자원 정보들을 가져와 체크 하는것이 아닌 우리가 만든 DB 에서 접근 자원 및 권한 정보들을 모두 가져 올수 있도록 Custom 할겁니다.</p>
<p>참고로 접근 자원 및 권한 정보 로직만 Custom 하고 그 이후 Spring Security 에서 구현한 권한 체크 담당은 AccessDecisionManager 에서 최종적으로 하게 됩니다.</p>
<p>즉 우리가 DB에(resource 테이블) 입력한 권한 목록 및 자원정보를 가져와 requestMap(Map 테이블)에 저장하고(동시에 빈으로 생성한다.) 호출된 resource url 과 requestMap 를 비교해서 해당되는 권한 정보가 있다면 </p>
<p>해당되는 권한 목록(requestMap) 중 권한 정보를 가져와 AccessDecisionManager 에 전달하게 되고 권한이 성립되는지 결정 하게 됩니다.</p>
<p>UrlFilterInvocationSecurityMetadataSource.java</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">@Slf4j</span><br><span class="line">public class UrlFilterInvocationSecurityMetadataSource implements FilterInvocationSecurityMetadataSource &#123;</span><br><span class="line"></span><br><span class="line"><span class="code">    private LinkedHashMap&lt;RequestMatcher, List&lt;ConfigAttribute&gt;&gt; requestMap = new LinkedHashMap&lt;&gt;();</span></span><br><span class="line"><span class="code">    private ResourceQueryService resourceQueryService;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">    public UrlFilterInvocationSecurityMetadataSource(LinkedHashMap&lt;RequestMatcher, List&lt;ConfigAttribute&gt;&gt; resourcesMap, ResourceQueryService resourceQueryService) &#123;</span></span><br><span class="line"><span class="code">        this.requestMap = resourcesMap;</span></span><br><span class="line"><span class="code">        this.resourceQueryService = resourceQueryService;</span></span><br><span class="line"><span class="code">    &#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">    @Override</span></span><br><span class="line"><span class="code">    public Collection&lt;ConfigAttribute&gt; getAttributes(Object o) throws IllegalArgumentException &#123;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">        HttpServletRequest request = ((FilterInvocation) o).getRequest();</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">        if (requestMap != null) &#123;</span></span><br><span class="line"><span class="code">            for (Map.Entry&lt;RequestMatcher, List&lt;ConfigAttribute&gt;&gt; entry : requestMap.entrySet()) &#123;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">                RequestMatcher matcher = entry.getKey();</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">                if (matcher.matches(request)) &#123;</span></span><br><span class="line"><span class="code">                    return entry.getValue();</span></span><br><span class="line"><span class="code">                &#125;</span></span><br><span class="line"><span class="code">            &#125;</span></span><br><span class="line"><span class="code">        &#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">        return null;</span></span><br><span class="line"><span class="code">    &#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">    @Override</span></span><br><span class="line"><span class="code">    public Collection&lt;ConfigAttribute&gt; getAllConfigAttributes() &#123;</span></span><br><span class="line"><span class="code">        Set&lt;ConfigAttribute&gt; allAttributes = new HashSet&lt;&gt;();</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">        for (Map.Entry&lt;RequestMatcher, List&lt;ConfigAttribute&gt;&gt; entry : requestMap.entrySet()) &#123;</span></span><br><span class="line"><span class="code">            allAttributes.addAll(entry.getValue());</span></span><br><span class="line"><span class="code">        &#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">        return allAttributes;</span></span><br><span class="line"><span class="code">    &#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">    @Override</span></span><br><span class="line"><span class="code">    public boolean supports(Class&lt;?&gt; aClass) &#123;</span></span><br><span class="line"><span class="code">        return FilterInvocation.class.isAssignableFrom(aClass);</span></span><br><span class="line"><span class="code">    &#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">    public void reload() &#123;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">        LinkedHashMap&lt;RequestMatcher, List&lt;ConfigAttribute&gt;&gt; reloadedMap = resourceQueryService.getResourceList();</span></span><br><span class="line"><span class="code">        Iterator&lt;Map.Entry&lt;RequestMatcher, List&lt;ConfigAttribute&gt;&gt;&gt; iterator = reloadedMap.entrySet().iterator();</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">        requestMap.clear();</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">        while (iterator.hasNext()) &#123;</span></span><br><span class="line"><span class="code">            Map.Entry&lt;RequestMatcher, List&lt;ConfigAttribute&gt;&gt; entry = iterator.next();</span></span><br><span class="line"><span class="code">            requestMap.put(entry.getKey(), entry.getValue());</span></span><br><span class="line"><span class="code">        &#125;</span></span><br><span class="line"><span class="code">    &#125;</span></span><br><span class="line"><span class="code">&#125;</span></span><br></pre></td></tr></table></figure>

<p><code>private LinkedHashMap&lt;RequestMatcher, List&lt;ConfigAttribute&gt;&gt; requestMap = new LinkedHashMap&lt;&gt;();</code></p>
<p>requestMap 에서는 스프링이 초기 기동시 우리가 만든 DB 에서 요청정보과 매칭되는 권한정보(resource 테이블) 가져와 저장하게 됩니다.</p>
<p>Key: 요청 url 정보<br><br>Value: 해당 요청 url 정보에 대한 role 정보 <br></p>
<p>Ex&gt; key -&gt; ‘api&#x2F;boards’, value -&gt; ‘ROLE_USER’</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public Collection<span class="language-xml"><span class="tag">&lt;<span class="name">ConfigAttribute</span>&gt;</span></span> getAttributes(Object o) throws IllegalArgumentException &#123;</span><br><span class="line"></span><br><span class="line"><span class="code">    HttpServletRequest request = ((FilterInvocation) o).getRequest();</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">    if (requestMap != null) &#123;</span></span><br><span class="line"><span class="code">        for (Map.Entry&lt;RequestMatcher, List&lt;ConfigAttribute&gt;&gt; entry : requestMap.entrySet()) &#123;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">            RequestMatcher matcher = entry.getKey();</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">            if (matcher.matches(request)) &#123;</span></span><br><span class="line"><span class="code">                return entry.getValue();</span></span><br><span class="line"><span class="code">            &#125;</span></span><br><span class="line"><span class="code">        &#125;</span></span><br><span class="line"><span class="code">    &#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">    return null;</span></span><br><span class="line"><span class="code">&#125;</span></span><br></pre></td></tr></table></figure>
<p>우리가 만든 DB 에서 요청정보과 매칭되는 권한정보(resource 테이블) 가져와 for 문으로 실행해서 실제 HttpServletRequest 통해 요청 url 매칭 된다면 </p>
<p>권한 정보를 추출 해서 리턴하게 됩니다.</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public boolean supports(Class&lt;?&gt; aClass) &#123;</span><br><span class="line"><span class="code">    return FilterInvocation.class.isAssignableFrom(aClass);</span></span><br><span class="line"><span class="code">&#125;</span></span><br></pre></td></tr></table></figure>

<p>앞써 설명한대로 Spring Security 에서는 URL 방식의 권한 검증과 메소드 방식의 권한 검증이 있습니다.</p>
<p>우리는 URL 방식으로 권한 정보를 검증하기 때문에 URL 방식으로 설정한 것이 통과 된다면 </p>
<p>Override 한 메소드가 실행 할 수 있도록 검증 하는 supports 메소드 입니다.</p>
<p>SecurityConfig.java</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@Bean</span><br><span class="line">public PermitAllFilter customFilterSecurityInterceptor() throws Exception &#123;</span><br><span class="line"></span><br><span class="line"><span class="code">    PermitAllFilter permitAllFilter = new PermitAllFilter(permitAllResources);</span></span><br><span class="line"><span class="code">    permitAllFilter.setSecurityMetadataSource(urlFilterInvocationSecurityMetadataSource());</span></span><br><span class="line"><span class="code">    permitAllFilter.setAccessDecisionManager(affirmativeBased());</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">    return permitAllFilter;</span></span><br><span class="line"><span class="code">&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PermitAllFilter permitAllFilter = new PermitAllFilter(permitAllResources);</span><br><span class="line">permitAllFilter.setSecurityMetadataSource(urlFilterInvocationSecurityMetadataSource());</span><br></pre></td></tr></table></figure>
<p>우리가 만든 UrlFilterInvocationSecurityMetadataSource 클래스를 기존 Spring Security 에서 사용되는 FilterInvocationSecurityMetadataSource 대신해 사용 하겠다는 의미이다.</p>
<p><code>permitAllFilter.setAccessDecisionManager(affirmativeBased());</code></p>
<p>접근 결정 관리자를 설정하는 부분 입니다. Spring Security 에서는 총 3가지가 있는데</p>
<ul>
<li>AffirmativeBased</li>
<li>ConsensusBased </li>
<li>UnanimousBased</li>
</ul>
<p>보편적으로 AffirmativeBased 를 많이 사용됩니다. 하나만 승인되도 통과됩니다.</p>
<h3 id="Spring-Security-UrlResourcesMapFactoryBean-구현하기"><a href="#Spring-Security-UrlResourcesMapFactoryBean-구현하기" class="headerlink" title="Spring Security UrlResourcesMapFactoryBean 구현하기"></a>Spring Security UrlResourcesMapFactoryBean 구현하기</h3><p>UrlResourcesMapFactoryBean.java</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">public class UrlResourcesMapFactoryBean implements FactoryBean<span class="language-xml">&lt;LinkedHashMap&lt;RequestMatcher, List<span class="tag">&lt;<span class="name">ConfigAttribute</span>&gt;</span></span>&gt;&gt; &#123;</span><br><span class="line"></span><br><span class="line"><span class="code">    private ResourceQueryService resourceQueryService;</span></span><br><span class="line"><span class="code">    private LinkedHashMap&lt;RequestMatcher, List&lt;ConfigAttribute&gt;&gt; resourceMap;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">    public void setSecurityResourceService(ResourceQueryService resourceQueryService) &#123;</span></span><br><span class="line"><span class="code">        this.resourceQueryService = resourceQueryService;</span></span><br><span class="line"><span class="code">    &#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">    @Override</span></span><br><span class="line"><span class="code">    public LinkedHashMap&lt;RequestMatcher, List&lt;ConfigAttribute&gt;&gt; getObject() throws Exception &#123;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">        if (resourceMap == null) &#123;</span></span><br><span class="line"><span class="code">            init();</span></span><br><span class="line"><span class="code">        &#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">        return resourceMap;</span></span><br><span class="line"><span class="code">    &#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">    private void init() &#123;</span></span><br><span class="line"><span class="code">        resourceMap = resourceQueryService.getResourceList();</span></span><br><span class="line"><span class="code">    &#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">    @Override</span></span><br><span class="line"><span class="code">    public Class&lt;?&gt; getObjectType() &#123;</span></span><br><span class="line"><span class="code">        return LinkedHashMap.class;</span></span><br><span class="line"><span class="code">    &#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">    @Override</span></span><br><span class="line"><span class="code">    public boolean isSingleton() &#123;</span></span><br><span class="line"><span class="code">        return true;</span></span><br><span class="line"><span class="code">    &#125;</span></span><br><span class="line"><span class="code">&#125;</span></span><br></pre></td></tr></table></figure>

<p>Spring 에서 지원하는 FactoryBean 을 이용해 Bean 을 생성 합니다.</p>
<p>Spring 기동시 DB 로부터 권한 정보 및 자원 정보를 가져와 (resource 테이블) resourceMap 에 Map 형식으로 저장 할겁니다.</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public LinkedHashMap<span class="language-xml">&lt;RequestMatcher, List<span class="tag">&lt;<span class="name">ConfigAttribute</span>&gt;</span></span>&gt; getObject() throws Exception &#123;</span><br><span class="line"></span><br><span class="line"><span class="code">    if (resourceMap == null) &#123;</span></span><br><span class="line"><span class="code">        init();</span></span><br><span class="line"><span class="code">    &#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">    return resourceMap;</span></span><br><span class="line"><span class="code">&#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line">private void init() &#123;</span><br><span class="line"><span class="code">    resourceMap = resourceQueryService.getResourceList();</span></span><br><span class="line"><span class="code">&#125;</span></span><br></pre></td></tr></table></figure>

<p>ResourceQueryService.java</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">private final ResourceRepository resourceRepository;</span><br><span class="line"></span><br><span class="line">public LinkedHashMap<span class="language-xml">&lt;RequestMatcher, List<span class="tag">&lt;<span class="name">ConfigAttribute</span>&gt;</span></span>&gt; getResourceList() &#123;</span><br><span class="line"></span><br><span class="line"><span class="code">    LinkedHashMap&lt;RequestMatcher, List&lt;ConfigAttribute&gt;&gt; result = new LinkedHashMap&lt;&gt;();</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">    List&lt;Resource&gt; resourcesList = resourceRepository.findAllResources();</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">    resourcesList.forEach(resource -&gt; &#123;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">        List&lt;ConfigAttribute&gt; configAttributeList = new ArrayList&lt;&gt;();</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">        resource.getRoleSet().forEach(role -&gt; &#123;</span></span><br><span class="line"><span class="code">            configAttributeList.add(new SecurityConfig(role.getName()));</span></span><br><span class="line"><span class="code">        &#125;);</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">        result.put(new AntPathRequestMatcher(resource.getName()), configAttributeList);</span></span><br><span class="line"><span class="code">    &#125;);</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">    return result;</span></span><br><span class="line"><span class="code">&#125;</span></span><br></pre></td></tr></table></figure>

<p>getResourceList 메소드는 DB 에 있는 resource 테이블의 데이터를 가져와서 Hash Map 으로 저장 하는 역활을 합니다.</p>
<p>resource 테이블과 매핑된 role 테이블의 데이터들을 가져와 ‘resourcesList’ HashMap 에 저장 합니다.</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public boolean isSingleton() &#123;</span><br><span class="line"><span class="code">    return true;</span></span><br><span class="line"><span class="code">&#125;</span></span><br></pre></td></tr></table></figure>

<p>해당 HashMap 은 싱글톤으로 관리 하도록 합시다.</p>
<p>SecurityConfig.java</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">private AccessDecisionManager affirmativeBased() &#123;</span><br><span class="line"></span><br><span class="line"><span class="code">    AffirmativeBased affirmativeBased = new AffirmativeBased(getAccessDecisionVoters());</span></span><br><span class="line"><span class="code">    return affirmativeBased;</span></span><br><span class="line"><span class="code">&#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line">private List<span class="language-xml">&lt;AccessDecisionVoter&lt;? extends Object&gt;</span>&gt; getAccessDecisionVoters() &#123;</span><br><span class="line"></span><br><span class="line"><span class="code">    List&lt;AccessDecisionVoter&lt;? extends Object&gt;&gt; accessDecisionVoters = new ArrayList&lt;&gt;();</span></span><br><span class="line"><span class="code">    accessDecisionVoters.add(roleVoter());  // Role Hierarchy 이용하기</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">    return accessDecisionVoters;</span></span><br><span class="line"><span class="code">&#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line">@Bean</span><br><span class="line">public AccessDecisionVoter&lt;? extends Object&gt; roleVoter() &#123;</span><br><span class="line"><span class="code">    RoleHierarchyVoter roleHierarchyVoter = new RoleHierarchyVoter(roleHierarchy());</span></span><br><span class="line"><span class="code">    return roleHierarchyVoter;</span></span><br><span class="line"><span class="code">&#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line">@Bean</span><br><span class="line">public RoleHierarchyImpl roleHierarchy() &#123;</span><br><span class="line"><span class="code">    RoleHierarchyImpl roleHierarchy = new RoleHierarchyImpl();</span></span><br><span class="line"><span class="code">    return roleHierarchy;</span></span><br><span class="line"><span class="code">&#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line">@Bean</span><br><span class="line">public FilterInvocationSecurityMetadataSource urlFilterInvocationSecurityMetadataSource() throws Exception &#123;</span><br><span class="line"><span class="code">    return new UrlFilterInvocationSecurityMetadataSource(urlResourcesMapFactoryBean().getObject(), resourceQueryService);</span></span><br><span class="line"><span class="code">&#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line">private UrlResourcesMapFactoryBean urlResourcesMapFactoryBean() &#123;</span><br><span class="line"></span><br><span class="line"><span class="code">    UrlResourcesMapFactoryBean urlResourcesMapFactoryBean = new UrlResourcesMapFactoryBean();</span></span><br><span class="line"><span class="code">    urlResourcesMapFactoryBean.setSecurityResourceService(resourceQueryService);</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">    return urlResourcesMapFactoryBean;</span></span><br><span class="line"><span class="code">&#125;</span></span><br></pre></td></tr></table></figure>
<p>마지막으로 Resource 권한 정보를 담겨져 있는 UrlResourcesMapFactoryBean 빈을 앞에 생성한 UrlFilterInvocationSecurityMetadataSource 클래스에게 전달 해야 합니다.</p>
<p>생성자로 통해 전달 하도록 합니다.</p>
<h3 id="인가처리-동적-반영하기"><a href="#인가처리-동적-반영하기" class="headerlink" title="인가처리 동적 반영하기"></a>인가처리 동적 반영하기</h3><p>Resource 테이블에 권한 정보 목록이 만약 수정 된다면 싱글톤으로 관리 하고 있는 ‘resourceMap’ 정보도 수정되어야 합니다.</p>
<p>UrlFilterInvocationSecurityMetadataSource.java</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">public boolean supports(Class&lt;?&gt; aClass) &#123;</span><br><span class="line"><span class="code">    return FilterInvocation.class.isAssignableFrom(aClass);</span></span><br><span class="line"><span class="code">&#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line">public void reload() &#123;</span><br><span class="line"></span><br><span class="line"><span class="code">    LinkedHashMap&lt;RequestMatcher, List&lt;ConfigAttribute&gt;&gt; reloadedMap = resourceQueryService.getResourceList();</span></span><br><span class="line"><span class="code">    Iterator&lt;Map.Entry&lt;RequestMatcher, List&lt;ConfigAttribute&gt;&gt;&gt; iterator = reloadedMap.entrySet().iterator();</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">    requestMap.clear();</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">    while (iterator.hasNext()) &#123;</span></span><br><span class="line"><span class="code">        Map.Entry&lt;RequestMatcher, List&lt;ConfigAttribute&gt;&gt; entry = iterator.next();</span></span><br><span class="line"><span class="code">        requestMap.put(entry.getKey(), entry.getValue());</span></span><br><span class="line"><span class="code">    &#125;</span></span><br><span class="line"><span class="code">&#125;</span></span><br></pre></td></tr></table></figure>
<p>UrlFilterInvocationSecurityMetadataSource 클래스에 reload 메소드를 새로 생성 합니다.</p>
<p><code>LinkedHashMap&lt;RequestMatcher, List&lt;ConfigAttribute&gt;&gt; reloadedMap = resourceQueryService.getResourceList();</code></p>
<p>새로 수정된 resource 정보 데이터를 DB 에서 가져와서 최신 정보로 reloadedMap 데이터에 업데이트 하게 됩니다.</p>
<h3 id="인가처리-PermitAllFilter-구현하기"><a href="#인가처리-PermitAllFilter-구현하기" class="headerlink" title="인가처리 PermitAllFilter 구현하기"></a>인가처리 PermitAllFilter 구현하기</h3><p>Spring Security 인가 처리 프로세스를 다시 생각해봅시다.</p>
<p>Spring 초기 기동시 resource 테이블에 데이터를 가져와 key (url 정보) value (권한정보) 를 reloadedMap 에 저장 합니다.</p>
<p>이후 요청 받을때 인가 처리시 초기에 FilterSecurityInterceptor 요청 받게 되는데 여기서 request 요청 url 를 이용해서</p>
<p>저장된 인증 정보 reloadedMap 에 해당 url 정보를 찾게 됩니다.</p>
<p>만약 정보가 없다면 null 로 리턴 하게 된다면 AccessDecisionManager 에 전달 되지 않아 인가 성립 시킵니다.</p>
<p>만약 해당 값이 존재한다면 reloadedMap 에 해당 권한 정보값과 유저 값을 AccessDecisionManager 에 전달하게 되고 권한이 성립되는지 결정 하게 됩니다.</p>
<p>우리는 여기서 PermitAllFilter(FilterSecurityInterceptor 상속 받는 클래스) 자체적으로 구현해서 인가 처리 할 필요없는 url 을 미리 특정 변수에 List 형식에 저장시키고 </p>
<p>요청 url 과 List 형식으로 저장한 인가 처리 할 필요없는 url 정보와 매핑 된다면 null 로 리턴 시켜 일부러 AccessDecisionManager 전달 되지 않게 해서 인가 성립 하게 됩니다.</p>
<p>SecurityConfig.java</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">private String[] permitAllResources = &#123;&quot;/&quot;, &quot;/categories&quot;&#125;;</span><br><span class="line"></span><br><span class="line">@Bean</span><br><span class="line">public PermitAllFilter customFilterSecurityInterceptor() throws Exception &#123;</span><br><span class="line"></span><br><span class="line"><span class="code">    PermitAllFilter permitAllFilter = new PermitAllFilter(permitAllResources);</span></span><br><span class="line"><span class="code">    permitAllFilter.setSecurityMetadataSource(urlFilterInvocationSecurityMetadataSource());</span></span><br><span class="line"><span class="code">    permitAllFilter.setAccessDecisionManager(affirmativeBased());</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">    return permitAllFilter;</span></span><br><span class="line"><span class="code">&#125;</span></span><br></pre></td></tr></table></figure>

<p>Spring Security 설정 페이지에서 우리가 인가 처리 할 필요없는 url 을 ‘permitAllResources’ 변수로 지정합니다.</p>
<p>그런 다음 FilterSecurityInterceptor extend 한 PermitAllFilter 클래스를 만들어 생성자 통해 값을 전달 시킵니다.</p>
<p>PermitAllFilter.java</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">public class PermitAllFilter extends FilterSecurityInterceptor &#123;</span><br><span class="line"></span><br><span class="line"><span class="code">    private static final String FILTER_APPLIED = &quot;__spring_security_filterSecurityInterceptor_filterApplied&quot;;</span></span><br><span class="line"><span class="code">    private boolean observeOncePerRequest = true;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">    private List&lt;RequestMatcher&gt; permitAllRequestMatchers =  new ArrayList&lt;&gt;();</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">    public PermitAllFilter(String...permitAllResources)&#123;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">        for (String resource : permitAllResources) &#123;</span></span><br><span class="line"><span class="code">            permitAllRequestMatchers.add(new AntPathRequestMatcher(resource));</span></span><br><span class="line"><span class="code">        &#125;</span></span><br><span class="line"><span class="code">    &#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">    @Override</span></span><br><span class="line"><span class="code">    protected InterceptorStatusToken beforeInvocation(Object object) &#123;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">        boolean permitAll = false;</span></span><br><span class="line"><span class="code">        HttpServletRequest request = ((FilterInvocation) object).getRequest();</span></span><br><span class="line"><span class="code">        for (RequestMatcher requestMatcher : permitAllRequestMatchers) &#123;</span></span><br><span class="line"><span class="code">            if (requestMatcher.matches(request)) &#123;</span></span><br><span class="line"><span class="code">                permitAll = true;</span></span><br><span class="line"><span class="code">                break;</span></span><br><span class="line"><span class="code">            &#125;</span></span><br><span class="line"><span class="code">        &#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">        if (permitAll) &#123;</span></span><br><span class="line"><span class="code">            return null;</span></span><br><span class="line"><span class="code">        &#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">        return super.beforeInvocation(object);</span></span><br><span class="line"><span class="code">    &#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">    public void invoke(FilterInvocation fi) throws IOException, ServletException &#123;</span></span><br><span class="line"><span class="code">        if ((fi.getRequest() != null)</span></span><br><span class="line"><span class="code">                &amp;&amp; (fi.getRequest().getAttribute(FILTER_APPLIED) != null)</span></span><br><span class="line"><span class="code">                &amp;&amp; observeOncePerRequest) &#123;</span></span><br><span class="line"><span class="code">            // filter already applied to this request and user wants us to observe</span></span><br><span class="line"><span class="code">            // once-per-request handling, so don&#x27;t re-do security checking</span></span><br><span class="line"><span class="code">            fi.getChain().doFilter(fi.getRequest(), fi.getResponse());</span></span><br><span class="line"><span class="code">        &#125; else &#123;</span></span><br><span class="line"><span class="code">            // first time this request being called, so perform security checking</span></span><br><span class="line"><span class="code">            if (fi.getRequest() != null &amp;&amp; observeOncePerRequest) &#123;</span></span><br><span class="line"><span class="code">                fi.getRequest().setAttribute(FILTER_APPLIED, Boolean.TRUE);</span></span><br><span class="line"><span class="code">            &#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">            InterceptorStatusToken token = beforeInvocation(fi);</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">            try &#123;</span></span><br><span class="line"><span class="code">                fi.getChain().doFilter(fi.getRequest(), fi.getResponse());</span></span><br><span class="line"><span class="code">            &#125;</span></span><br><span class="line"><span class="code">            finally &#123;</span></span><br><span class="line"><span class="code">                super.finallyInvocation(token);</span></span><br><span class="line"><span class="code">            &#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">            super.afterInvocation(token, null);</span></span><br><span class="line"><span class="code">        &#125;</span></span><br><span class="line"><span class="code">    &#125;</span></span><br><span class="line"><span class="code">&#125;</span></span><br></pre></td></tr></table></figure>

<p>beforeInvocation 메소드를 override 를 해서 요청 url 값과 생성자 통해 주입 받았던 인가 처리 할 필요없는 url 정보 데이터와 매핑 되는지 </p>
<p>체크 후 매핑 되는것이 없다면 null 반환 시켜 AccessDecisionManager 전달 되지 않게 해서 인가 성립 하게 됩니다.</p>
<h3 id="인가처리-계층-권한-구현하기"><a href="#인가처리-계층-권한-구현하기" class="headerlink" title="인가처리 계층 권한 구현하기"></a>인가처리 계층 권한 구현하기</h3><p>앞써 role 테이블 우리는 </p>
<ul>
<li>ROLE_SUPER_ADMIN</li>
<li>ROLE_ADMIN</li>
<li>ROLE_CLIENT</li>
<li>ROLE_USER</li>
</ul>
<p>이렇게 총 4개 role 정보를 설정 했습니다.</p>
<p>그런데 만약 해당 resource 정보가 ‘ROLE_CLIENT’ 이라면 그보다 계층이 높은 ‘ROLE_SUPER_ADMIN’ 통해 유저가 해당 자원을 접속 할 경우 </p>
<p>권한을 통과 되도록 해야 합니다. 하지만 일반적으로 Spring Security 에서는 설정을 하지 않는 이상 ‘ROLE_SUPER_ADMIN’ 이나’ROLE_CLIENT’ 는 서로 다른 권한 정보로 판단합니다.</p>
<p>즉 ‘ROLE_SUPER_ADMIN’ 는 ‘ROLE_CLIENT’ 보다 높은 계층 권한임을 설정 해야 합니다.</p>
<p>그것이 role_hierarchy 테이블이 있는 이유 입니다.</p>
<table>
<thead>
<tr>
<th>parent_name</th>
<th>child_name</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td>ROLE_SUPER_ADMIN</td>
</tr>
<tr>
<td>ROLE_SUPER_ADMIN</td>
<td>ROLE_ADMIN</td>
</tr>
<tr>
<td>ROLE_ADMIN</td>
<td>ROLE_CLIENT</td>
</tr>
<tr>
<td>ROLE_CLIENT</td>
<td>ROLE_USER</td>
</tr>
</tbody></table>
<p>-&gt; ROLE_SUPER_ADMIN &gt; ROLE_ADMIN &gt; ROLE_CLIENT &gt; ROLE_USER</p>
<p>parent_name, child_name 각각 지정 하므로써 각각 role 권한 정보가 어떤 계층인지 표현 할 수 있습니다.</p>
<p>SecurityConfig.java</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">private List<span class="language-xml">&lt;AccessDecisionVoter&lt;? extends Object&gt;</span>&gt; getAccessDecisionVoters() &#123;</span><br><span class="line"></span><br><span class="line"><span class="code">    List&lt;AccessDecisionVoter&lt;? extends Object&gt;&gt; accessDecisionVoters = new ArrayList&lt;&gt;();</span></span><br><span class="line"><span class="code">    accessDecisionVoters.add(roleVoter());  // Role Hierarchy 이용하기</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">    return accessDecisionVoters;</span></span><br><span class="line"><span class="code">&#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line">@Bean</span><br><span class="line">public AccessDecisionVoter&lt;? extends Object&gt; roleVoter() &#123;</span><br><span class="line"><span class="code">    RoleHierarchyVoter roleHierarchyVoter = new RoleHierarchyVoter(roleHierarchy());</span></span><br><span class="line"><span class="code">    return roleHierarchyVoter;</span></span><br><span class="line"><span class="code">&#125;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line">@Bean</span><br><span class="line">public RoleHierarchyImpl roleHierarchy() &#123;</span><br><span class="line"><span class="code">    RoleHierarchyImpl roleHierarchy = new RoleHierarchyImpl();</span></span><br><span class="line"><span class="code">    return roleHierarchy;</span></span><br><span class="line"><span class="code">&#125;</span></span><br></pre></td></tr></table></figure>
<p>Spring Security 에서 각각의 권한 설정의 계층을 설정 할때 </p>
<p><code>ROLE_SUPER_ADMIN &gt; ROLE_ADMIN &gt; ROLE_CLIENT &gt; ROLE_USER</code></p>
<p>이렇게 String 형식으로 전달 하게 하면 됩니다. 이것을 Spring Security 에서 지원하는 RoleHierarchy 클래스에 전달 하면 됩니다.</p>
<p>RoleHierarchy 구현체인 RoleHierarchyImpl 를 빈으로 등록 한 다음 (빈으로 등록한 이유는 바로 아래 설명이 나옵니다.) RoleHierarchyVoter 생성자로 주입 하면 됩니다.</p>
<p>RoleHierarchyQueryService.java</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">private final RoleHierarchyRepository roleHierarchyRepository;</span><br><span class="line"> </span><br><span class="line"> public String selectHierarchies() &#123;</span><br><span class="line"> </span><br><span class="line"><span class="code">     List&lt;RoleHierarchy&gt; rolesHierarchy = roleHierarchyRepository.findAll();</span></span><br><span class="line"><span class="code"> </span></span><br><span class="line"><span class="code">     Iterator&lt;RoleHierarchy&gt; roleHierarchyIterator = rolesHierarchy.iterator();</span></span><br><span class="line"><span class="code">     StringBuilder stringBuilder = new StringBuilder();</span></span><br><span class="line"><span class="code"> </span></span><br><span class="line"><span class="code">     while (roleHierarchyIterator.hasNext()) &#123;</span></span><br><span class="line"><span class="code"> </span></span><br><span class="line"><span class="code">         RoleHierarchy roleHierarchy = roleHierarchyIterator.next();</span></span><br><span class="line"><span class="code">         if (roleHierarchy.getParentName() != null) &#123;</span></span><br><span class="line"><span class="code">             stringBuilder.append(roleHierarchy.getParentName().getChildName());</span></span><br><span class="line"><span class="code">             stringBuilder.append(&quot; &gt; &quot;);</span></span><br><span class="line"><span class="code">             stringBuilder.append(roleHierarchy.getChildName());</span></span><br><span class="line"><span class="code">             stringBuilder.append(&quot;\n&quot;);</span></span><br><span class="line"><span class="code">         &#125;</span></span><br><span class="line"><span class="code">     &#125;</span></span><br><span class="line"><span class="code"> </span></span><br><span class="line"><span class="code">     return stringBuilder.toString();</span></span><br><span class="line"><span class="code"> &#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@Component</span><br><span class="line">@RequiredArgsConstructor</span><br><span class="line">public class SecurityInitializer implements ApplicationRunner &#123;</span><br><span class="line"></span><br><span class="line"><span class="code">    private final RoleHierarchyQueryService roleHierarchyQueryService;</span></span><br><span class="line"><span class="code">    private final RoleHierarchyImpl roleHierarchy;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">    @Override</span></span><br><span class="line"><span class="code">    public void run(ApplicationArguments args) throws Exception &#123;</span></span><br><span class="line"><span class="code">        String allHierarchy = roleHierarchyQueryService.selectHierarchies();</span></span><br><span class="line"><span class="code">        roleHierarchy.setHierarchy(allHierarchy);</span></span><br><span class="line"><span class="code">    &#125;</span></span><br></pre></td></tr></table></figure>

<p>ApplicationRunner 이용해서 Spring Boot 기동 될때 RoleHierarchyQueryService 클래스의 selectHierarchies 메소드를 호출 해서 </p>
<p>role_hierarchy 테이블에 있는 계층 권한 정보를 가져와 </p>
<p><code>ROLE_SUPER_ADMIN &gt; ROLE_ADMIN &gt; ROLE_CLIENT &gt; ROLE_USER</code> </p>
<p>이렇게 String 형식으로 return 하게 됩니다. Spring Security 설정 페이지에서 빈으로 등록한 ‘RoleHierarchyImpl’ 에 setHierarchy 메소드에 전달 하게 되면 설정은 끝나게 됩니다.</p>
<h3 id="마치면서"><a href="#마치면서" class="headerlink" title="마치면서"></a>마치면서</h3><p>권한의 인증 인가 처리는 실제 프로젝트 운영시 아주 중요한 요소 입니다. 한번의 실수로 모든 서비스가 엉망이 되기 때문입니다.</p>
<p>이 중요한 인증 인가 처리를 처음부터 끝까지 직접 손으로 하나하나 구현하는 것은 너무 힘든 부분이 아닐수 없습니다.</p>
<p>그래서 Spring Security 의 힘을 빌려서 최소한의 설정 및 커스텀 해서 서비스에 알맞게 반영 하였습니다.</p>
<p>그러나 전반적인 Spring Security 내용과 흐름을 알지 못하는 상황이라면 어려운 요소 일수도 있습니다.</p>
<p>그만큼 권한 부분은 어렵다고 느껴집니다. 다음에는 Spring Security 심도있게 준비해서 다음 블로그를 준비 하도록 하겠습니다.</p>
<p>여기까지 읽어주셔서 감사합니다.</p>

      
       <hr><span style="font-style: italic;color: gray;"> Copyright 201- syh8088. 무단 전재 및 재배포 금지. 출처 표기 시 인용 가능. </span>
    </div>
</article>


<p>
    <a  class="dashang" onclick="dashangToggle()">💰</a>
</p>






    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    ©2017 Seo Yang Hun
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="Toggle full screen shortcut key s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

<div class="hide_box" onclick="dashangToggle()"></div>
<div class="shang_box">
    <a class="shang_close"  onclick="dashangToggle()">×</a>
    <div class="shang_tit">
        <p>Help us with donation</p>
    </div>
    <div class="shang_payimg">
        <div class="pay_img">
            <img src="/img/alipay.jpg" class="alipay" title="扫码支持">
            <img src="/img/weixin.jpg" class="weixin" title="扫码支持">
        </div>
    </div>
    <div class="shang_payselect">
        <span><label><input type="radio" name="pay" checked value="alipay">alipay</label></span><span><label><input type="radio" name="pay" value="weixin">weixin</label></span>
    </div>
</div>


</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        
        $("input[name=pay]").on("click", function () {
            if($("input[name=pay]:checked").val()=="weixin"){
                $(".shang_box .shang_payimg .pay_img").addClass("weixin_img");
            } else {
                $(".shang_box .shang_payimg .pay_img").removeClass("weixin_img");
            }
        })
        

        /*高亮代码块行号*/
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*打赏页面隐藏与展示*/
    
    function dashangToggle() {
        $(".shang_box").fadeToggle();
        $(".hide_box").fadeToggle();
    }
    

</script>

<!--加入行号的高亮代码块样式-->

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*列表样式*/
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    

    
</style>







</html>
